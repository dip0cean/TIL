# Servlet

- **요청 당 스레드**를 사용하며 프로세스를 사용하는 CGI 와 차이점이 있다.
    - 메모리 사용에 대한 효율이 높다.
    - OS 플랫폼 독립적이며 이식성이 높다.
    - Java 및 Spring Framework Container 가 제공하는 보안과 관련된 기능 지원을 받을 수 있다.

## Servlet Life Cycle

- `Servlet Container` 가  `Servlet Instance` 의 `init()` 메소드를 호출해 초기화된다.
    - 최초 요청을 받았을 때 초기화 하고 나면 그 다음 요청부터는 해당 과정을 생략한다.
- `Servlet` 이 초기화 된 다음부터 클라이언트 요청을 처리할 수 있으며, 각 요청은 별도의 스레드로 처리하고 이때 `Servlet Instance` 의 `service()` 메소드를 호출해 실질적인 로직이 수행된다.
    - `service()` 메소드는 파라미터 인자로 `HttpRequest`, `HttpResponse` 객체를 인자로 받아 요청을 처리한 뒤 응답한다.
    - `service()` 메소드는 보통 HTTP Method 에 따라 `doGet()`, `doPost()` 등으로 처리를 위임한다.
    - `Servlet Container` 판단에 따라 `Servlet Instance` 를 메모리에서 내려야 할 시점에 `destroy()` 메소드를 호출한다. (제어의 역전)

## Servlet Listener

- 웹 애플리케이션에서 발생하는 주요 이벤트를 감지하고, 각 이벤트에 특별한 작업이 필요한 경우에 사용할 수 있다.
    - Servlet Context 수준의 이벤트
        - Context Life Cycle Event
        - Context Attribute 변경 이벤트
    - Session 수준의 이벤트
        - Session Life Cycle 이벤트
        - Session Attribute 변경 이벤트

## Servlet Filter

![servlet filter chain](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/e077b94b-35ac-4a4f-bf1a-5380a5bbba57/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220118%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220118T223645Z&X-Amz-Expires=86400&X-Amz-Signature=b1130c1dc40e5797736276946ac3e4839cb57d453a249e3c6b1d9c584e70fbb5&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)

- 들어온 요청을 `Servlet` 으로 보내고, 또 `Servlet` 이 작성한 응답을 클라이언트로 보내기 전에 별도의 처리가 필요한 경우에 사용할 수 있다.
- 체인 형태의 구조를 가지고 있어 순차적으로 적용되어 있다.
- Servlet Listener → Servlet Filter → Servlet